

<!DOCTYPE html>
<html lang="en" >



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/YXY.png">
  <link rel="icon" href="/img/YXY.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#c30000">
  <meta name="author" content="Xiyuan Yang">
  <meta name="keywords" content="Code">
  
    <meta name="description" content="An advanced tutorial focusing on file management in Python.">
<meta property="og:type" content="article">
<meta property="og:title" content="Python-Advanced-File-Management">
<meta property="og:url" content="https://xiyuanyang-code.github.io/posts/Python-advanced-File-Management/index.html">
<meta property="og:site_name" content="Xiyuan Yang&#39;s Blog">
<meta property="og:description" content="An advanced tutorial focusing on file management in Python.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://xiyuanyang-code.github.io/img/cover/filespython.jpg">
<meta property="article:published_time" content="2025-01-16T05:02:00.000Z">
<meta property="article:modified_time" content="2025-02-17T11:46:54.067Z">
<meta property="article:author" content="Xiyuan Yang">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Tutorial">
<meta property="article:tag" content="Files">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://xiyuanyang-code.github.io/img/cover/filespython.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Python-Advanced-File-Management - Xiyuan Yang&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xiyuanyang-code.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":50,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"❡"},"progressbar":{"enable":true,"height_px":3,"color":"red","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":2},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"L7r0uGb0fafbzNvmBADCMH42-gzGzoHsz","app_key":"2Lr1fQ2rjhwRiUrDx0VOQyUm","server_url":null,"path":"window.location.pathname","ignore_local":true},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Xiyuan Yang&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/above/" target="_self">
                <i class="iconfont icon-bookmark-fill"></i>
                <span>Intro</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archive</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Category</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tag</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="https://xiyuanyang-code.github.io/My-Resume/" target="_self">
                <i class="iconfont icon-code"></i>
                <span>Resume</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/FAQ/" target="_self">
                <i class="iconfont icon-bug"></i>
                <span>FAQ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/place.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Python-Advanced-File-Management"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Xiyuan Yang
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-01-16 13:02" pubdate>
          January 16, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.5k words
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="Code"
        id="heading-ca0dbad92a874b2f69b549293387925e" role="tab" data-toggle="collapse" href="#collapse-ca0dbad92a874b2f69b549293387925e"
        aria-expanded="true"
      >
        Code
        <span class="list-group-count">(15)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-ca0dbad92a874b2f69b549293387925e"
           role="tabpanel" aria-labelledby="heading-ca0dbad92a874b2f69b549293387925e">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/posts/C-plus-plus-Primer-Plus-tutorial/" title="C-Plus-Plus-Primer-Plus-Tutorial"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">C-Plus-Plus-Primer-Plus-Tutorial</span>
        </a>
      
    
      
      
        <a href="/posts/Introduction-to-OOP/" title="Introduction-to-OOP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Introduction-to-OOP</span>
        </a>
      
    
      
      
        <a href="/posts/Dynamic-Memory-and-Classes/" title="Dynamic-Memory-and-Classes"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Dynamic-Memory-and-Classes</span>
        </a>
      
    
      
      
        <a href="/posts/Class-Inheritance/" title="Class-Inheritance"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Class-Inheritance</span>
        </a>
      
    
      
      
        <a href="/posts/Code-Reuse-in-OOP/" title="Code-Reuse-in-OOP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Code-Reuse-in-OOP</span>
        </a>
      
    
      
      
        <a href="/posts/Exception-Handling-in-C-plus-plus/" title="Exception-Handling-in-C-Plus-Plus"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Exception-Handling-in-C-Plus-Plus</span>
        </a>
      
    
      
      
        <a href="/posts/Pointers-Arrays-and-Functions/" title="Pointers-Arrays-and-Functions"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Pointers-Arrays-and-Functions</span>
        </a>
      
    
      
      
        <a href="/posts/Input-and-Output-in-C-plus-plus/" title="Input-and-Output-in-C-Plus-Plus"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Input-and-Output-in-C-Plus-Plus</span>
        </a>
      
    
      
      
        <a href="/posts/Jotting-References-and-Encapsulation-in-OOP/" title="Jotting-References-and-Encapsulation-in-OOP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Jotting-References-and-Encapsulation-in-OOP</span>
        </a>
      
    
      
      
        <a href="/posts/Python-tutorial/" title="Python-Tutorial"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-Tutorial</span>
        </a>
      
    
      
      
        <a href="/posts/Python-cheatsheet/" title="Python-Cheatsheet"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-Cheatsheet</span>
        </a>
      
    
      
      
        <a href="/posts/Python-advanced-File-Management/" title="Python-Advanced-File-Management"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Python-Advanced-File-Management</span>
        </a>
      
    
      
      
        <a href="/posts/Python-Update-Learning/" title="Python-Update-Learning"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-Update-Learning</span>
        </a>
      
    
      
      
        <a href="/posts/Regular-Expression/" title="Regular-Expression"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Regular-Expression</span>
        </a>
      
    
      
      
        <a href="/posts/Python-visualization/" title="Python-Visualization"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-Visualization</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Python-Advanced-File-Management</h1>
            
            
              <div class="markdown-body">
                
                <style>
  html, body, .markdown-body {
    font-family: Georgia, sans, serif;
  }
</style>

<h1 id="Advanced-Python-Techniques-File-Management"><a href="#Advanced-Python-Techniques-File-Management" class="headerlink" title="Advanced Python Techniques: File Management"></a>Advanced Python Techniques: File Management</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><a href="https://xiyuanyang-code.github.io/posts/Python-tutorial/">Updating  Plan</a></p>
<p>Today, we will introduce how to manage files (such as reading files and writing files) in Python.</p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><h2 id="Import-Modules"><a href="#Import-Modules" class="headerlink" title="Import Modules"></a>Import Modules</h2><p>在Python中，<strong>模块（Module）</strong>是一个包含Python代码的文件，通常以 <code>.py</code> 为扩展名。模块可以包含函数、类、变量和可执行代码。</p>
<h3 id="Basic-Grammer"><a href="#Basic-Grammer" class="headerlink" title="Basic Grammer"></a>Basic Grammer</h3><p>导入模块最常用的命令是<code>import</code>命令，我们可以使用<code>import</code>命令导入<strong>Python中的第三方模块</strong>。（类似于C++中的<code>#include</code>命令）</p>
<p>在导入模块的过程中，有如下的四种方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># 第一种导入方式：把整个模块全部导入</span><br><span class="hljs-keyword">import</span> math<br><span class="hljs-comment"># 使用 math 模块中的 sqrt 函数</span><br>result = math.sqrt(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 输出: 4.0</span><br><br><br><span class="hljs-comment"># 第二种导入方式：导入模块的特定内容</span><br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<br><span class="hljs-comment"># 直接使用 sqrt 函数</span><br>result = sqrt(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 输出: 4.0</span><br><br><br><span class="hljs-comment"># 第三种导入方式：导入模块的全部内容</span><br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># 直接使用 sqrt 函数</span><br>result = sqrt(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 输出: 4.0</span><br><br><br><span class="hljs-comment"># 第四种导入方式：起别名 </span><br><span class="hljs-keyword">import</span> math <span class="hljs-keyword">as</span> m<br><span class="hljs-comment"># 使用别名 m 访问 sqrt 函数</span><br>result = m.sqrt(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 输出: 4.0</span><br><br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt <span class="hljs-keyword">as</span> square_root<br><span class="hljs-comment"># 使用别名 square_root</span><br>result = square_root(<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 输出: 4.0</span><br></code></pre></td></tr></table></figure>

<h3 id="Import-Class"><a href="#Import-Class" class="headerlink" title="Import Class"></a>Import Class</h3><p>为了提升代码的简洁性，<strong>类的定义</strong>被储存在特定的文件中，在开发者使用是可以被<strong>特定的导入</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># All_the_class.py</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bike</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Truck</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-comment"># main.py</span><br><br><span class="hljs-keyword">import</span> All_the_class<br><br><span class="hljs-keyword">from</span> All_the_class <span class="hljs-keyword">import</span> Car<br><br><span class="hljs-keyword">from</span> All_the_class <span class="hljs-keyword">import</span> Bike,Car<br><span class="hljs-comment"># 这三种导入方式都是合法的！</span><br></code></pre></td></tr></table></figure>

<h3 id="Dive-Deeper"><a href="#Dive-Deeper" class="headerlink" title="Dive Deeper"></a>Dive Deeper</h3><div class="note note-info">
            <h4 id="How-do-Python-import-modules"><a href="#How-do-Python-import-modules" class="headerlink" title="How do Python import modules?"></a>How do Python import modules?</h4><p>当你导入一个模块时，Python 会按照以下顺序查找模块：</p><ol><li><strong>内置模块</strong>：Python 自带的标准库模块。</li><li><strong>当前目录</strong>：运行脚本所在的目录。</li><li>**环境变量 <code>PYTHONPATH</code>**：包含目录列表的环境变量。</li><li><strong>安装的第三方库</strong>：通过 <code>pip</code> 安装的第三方模块。</li></ol><p><strong>当前目录</strong>是指该文件所在的目录地址，例如下面的文件结构：</p><ul><li><code>thefilefolder</code><ul><li><code>testcode2.py</code></li><li><code>testcode3.py</code></li></ul></li><li><code>testcode1.py</code></li></ul><p>对于<code>testcode2.py</code>来说，当前目录下有文件<code>testcode3.py</code>，而没有<code>testcode1.py</code>。</p><p><strong><code>PYTHONPATH</code> 允许你添加自定义的目录路径</strong>，使得 Python 在导入模块时能够从这些目录中查找模块文件。这对于以下场景非常有用：</p><ol><li><strong>自定义模块路径</strong>：当你有一些自定义的模块不在当前目录或 Python 的标准库路径中时，可以通过 <code>PYTHONPATH</code> 指定这些模块所在的目录。</li><li><strong>项目结构管理</strong>：在大型项目中，模块可能分布在不同的目录中，通过 <code>PYTHONPATH</code> 可以方便地管理这些模块的路径。</li></ol>
          </div>

<p>从上文可知，文件的导入并不局限于官方库文件的导入，你也可以导入<strong>自己写的Python文件</strong>！</p>
<h4 id="name"><a href="#name" class="headerlink" title="__name__"></a><code>__name__</code></h4><p>我们来看下面的例子，这是在同一个目录下的两个Python文件<code>testcode4.py</code>和<code>testcode5.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># testcode5.py</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello! This is the file testcode5.py!&quot;</span>)<br><br><span class="hljs-comment"># testcode4.py</span><br><span class="hljs-keyword">import</span> testcode5<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello! this is testcode4.py&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>运行<code>testcode4.py</code>，输出结果如下：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">Hello! This <span class="hljs-keyword">is</span> the file testcode5.py!<br>Hello! <span class="hljs-keyword">this</span> <span class="hljs-keyword">is</span> testcode4.py<br></code></pre></td></tr></table></figure>

<p>实际上，Python解释器运行代码的顺序和逻辑如下：</p>
<ol>
<li>**运行 <code>testcode4.py</code>**：<ul>
<li>Python 解释器开始执行 <code>testcode4.py</code> 文件。</li>
<li>当遇到 <code>import testcode5</code> 时，Python 会查找并加载 <code>testcode5.py</code> 模块。</li>
</ul>
</li>
<li>**加载并执行 <code>testcode5.py</code>**：<ul>
<li>Python 会执行 <code>testcode5.py</code> 文件中的<strong>所有顶层代码（即不在函数或类中的代码）</strong>。</li>
<li>在 <code>testcode5.py</code> 中，<code>print(&quot;Hello! This is the file testcode5.py!&quot;)</code> 是顶层代码，因此会被执行。</li>
<li>执行完 <code>testcode5.py</code> 后，Python 会回到 <code>testcode4.py</code> 继续执行。</li>
</ul>
</li>
<li>**继续执行 <code>testcode4.py</code>**：<ul>
<li>在 <code>testcode4.py</code> 中，<code>import testcode5</code> 已经完成，接下来执行 <code>print(&quot;Hello! this is testcode4.py&quot;)</code>。</li>
<li>因此，<code>testcode4.py</code> 中的 <code>print</code> 语句会被执行。</li>
</ul>
</li>
</ol>
<p>这就出现了很尴尬的问题，我们设置<code>print</code>语句的初衷是告知程序员现在在运行哪一个文件，我们<strong>不希望模块被导入的输出相同的结果</strong>，换句话说，我们希望将一个程序<strong>作为模块被导入运行和直接运行</strong>的行为产生差异。</p>
<blockquote>
<p>这是一个很实际的问题，模块的使用者直接导入模块，而模块的开发者需要调试信息，就需要这样一种<strong>分离</strong>的策略。</p>
</blockquote>
<p>一种方法是将所有的代码写成函数，<strong>这样不存在顶层代码一说了</strong>，但是这对模块开发和调试的功能有增添了不便之处。实际上，每个文件都有一个**<code>__name__</code> 属性**，灵活使用<code>__name__</code>可以很好的解决这个问题。</p>
<p>我们略微修改刚刚的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># testcode5.py</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello! This is the file testcode5.py!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;testcode5 __name__: <span class="hljs-subst">&#123;__name__&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># testcode4.py</span><br><span class="hljs-keyword">import</span> testcode5<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello! this is testcode4.py&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;testcode4 __name__: <span class="hljs-subst">&#123;__name__&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">when you run testcode5.py:</span><br><span class="hljs-string">Hello! This is the file testcode5.py!</span><br><span class="hljs-string">testcode5 __name__: __main__</span><br><span class="hljs-string"></span><br><span class="hljs-string">when you run testcode4.py:</span><br><span class="hljs-string">Hello! This is the file testcode5.py!</span><br><span class="hljs-string">testcode5 __name__: testcode5</span><br><span class="hljs-string">Hello! this is testcode4.py</span><br><span class="hljs-string">testcode4 __name__: __main__</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>我们很惊喜的发现，<strong>被导入的文件</strong>和<strong>直接被运行的文件</strong>的<code>__name__</code>属性是不一样的！当一个文件被导入的时候，<code>__name__</code>字符串的值就是其文件名（例如<code>testcode5</code>），而被直接运行的时候，<code>__name__</code>的值变成了<code>__main__</code>。</p>
<p>因此，我们可以使用<code>if __name__ == &quot;__main__&quot;</code>语句来封装<strong>顶层代码</strong>，实现我们上文的需求！</p>
<h2 id="File-Reading-and-Writing"><a href="#File-Reading-and-Writing" class="headerlink" title="File Reading and Writing"></a>File Reading and Writing</h2><h3 id="What-is-path"><a href="#What-is-path" class="headerlink" title="What is path?"></a>What is path?</h3><p><strong>路径（path）</strong>是指文件或文件夹在系统中的准确位置，<strong>类似于每家每户的门牌号</strong>。当Python想要读取一个文件时，首先需要获得<strong>文件的地址（即路径）</strong>，这样文件才能被找到并被成功读取。</p>
<p>路径分为两类，<strong>相对路径</strong>和<strong>绝对路径</strong>。</p>
<ul>
<li>绝对路径是从文件系统的根目录开始的完整路径，它唯一地标识一个文件或目录的位置。</li>
<li>相对路径是相对于当前工作目录的路径，它依赖于当前的工作环境。</li>
</ul>
<blockquote>
<p>通俗一点来说，如果我们要描述小明的绝对路径，我们要从<strong>根目录</strong>（不妨假设为地球）开始说，小明住在哪个大洲哪个国家哪个区域哪个街道哪个门牌号…但如果我站在<strong>当前工作目录</strong>（不妨假设为<code>地球/亚洲/中国</code>）,我们可以直接从小明住在哪个区域开始说起就行了。但是如果远在美洲的朋友就无法识别这个相对路径（因为<strong>当前工作目录发生了改变</strong>）。</p>
</blockquote>
<p><img src="https://ooo.0x0.ooo/2025/01/19/OGkztG.png" srcset="/img/loading.gif" lazyload alt="The Absolute Path and the Relative Path"></p>
<h3 id="pathlib"><a href="#pathlib" class="headerlink" title="pathlib"></a><code>pathlib</code></h3><p><code>pathlib</code> 是 Python 3.4 引入的一个模块，提供了一种面向对象的方式来处理文件系统路径。</p>
<p><code>pathlib</code> 的核心类是 <code>Path</code>，它表示文件系统路径。<code>Path</code> 类有两种主要子类：</p>
<ul>
<li>**<code>PurePath</code>**：纯路径类，只处理路径字符串，不涉及实际文件系统操作。</li>
<li>**<code>Path</code>**：具体路径类，继承自 <code>PurePath</code>，可以执行实际的文件系统操作（如创建文件、读取文件等）。</li>
</ul>
<ol>
<li>创建 <code>Path</code> 对象</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><span class="hljs-comment"># 创建 Path 对象</span><br>p = Path(<span class="hljs-string">&#x27;example.txt&#x27;</span>)<br><span class="hljs-built_in">print</span>(p)  <span class="hljs-comment"># 输出: example.txt</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>路径拼接</li>
</ol>
<p>使用 <code>/</code> 运算符可以轻松拼接路径。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">p = Path(<span class="hljs-string">&#x27;/path/to&#x27;</span>)<br>p = p / <span class="hljs-string">&#x27;subdir&#x27;</span> / <span class="hljs-string">&#x27;file.txt&#x27;</span><br><span class="hljs-built_in">print</span>(p)  <span class="hljs-comment"># 输出: /path/to/subdir/file.txt</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>获取路径的组成部分</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">p = Path(<span class="hljs-string">&#x27;/path/to/file.txt&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(p.name)       <span class="hljs-comment"># 输出: file.txt（文件名）</span><br><span class="hljs-built_in">print</span>(p.stem)       <span class="hljs-comment"># 输出: file（文件名不带后缀）</span><br><span class="hljs-built_in">print</span>(p.suffix)     <span class="hljs-comment"># 输出: .txt（文件后缀）</span><br><span class="hljs-built_in">print</span>(p.parent)     <span class="hljs-comment"># 输出: /path/to（父目录）</span><br><span class="hljs-built_in">print</span>(p.absolute()) <span class="hljs-comment"># 输出: 绝对路径</span><br></code></pre></td></tr></table></figure>

<ol start="4">
<li>检查路径是否存在</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">p = Path(<span class="hljs-string">&#x27;example.txt&#x27;</span>)<br><span class="hljs-keyword">if</span> p.exists():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;文件存在&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;文件不存在&quot;</span>)<br><span class="hljs-comment"># 这里查找的是相对目录下的文件</span><br></code></pre></td></tr></table></figure>

<ol start="5">
<li>创建文件和目录</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 创建文件</span><br>p = Path(<span class="hljs-string">&#x27;new_file.txt&#x27;</span>)<br>p.touch()  <span class="hljs-comment"># 创建空文件</span><br><br><span class="hljs-comment"># 创建目录</span><br>p = Path(<span class="hljs-string">&#x27;new_directory&#x27;</span>)<br>p.mkdir(exist_ok=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># exist_ok=True 避免目录已存在时报错</span><br></code></pre></td></tr></table></figure>

<ol start="6">
<li>读取和写入文件</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 写入文件</span><br>p = Path(<span class="hljs-string">&#x27;example.txt&#x27;</span>)<br>p.write_text(<span class="hljs-string">&#x27;Hello, World!&#x27;</span>)<br><br><span class="hljs-comment"># 注意！原来文件中的内容会被write_text()所覆盖</span><br>path.<span class="hljs-built_in">open</span>(mode=<span class="hljs-string">&#x27;a&#x27;</span>).write(<span class="hljs-string">&quot;Hello&quot;</span>)<br><span class="hljs-comment"># 可以使用追加模式</span><br><br><br><span class="hljs-comment"># 读取文件</span><br>content = p.read_text()<br><span class="hljs-built_in">print</span>(content)  <span class="hljs-comment"># 输出: Hello, World!</span><br></code></pre></td></tr></table></figure>

<p>我们还可以实现一些更高级的操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br>path = Path(<span class="hljs-string">&quot;example.txt&quot;</span>)<br>contents = path.read_text()<br><br>lines = contents.splitlines()<br><span class="hljs-comment"># 会返回一个列表</span><br><span class="hljs-keyword">for</span> i,line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;The <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span> line is <span class="hljs-subst">&#123;line&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">The <span class="hljs-number">1</span> <span class="hljs-type">line</span> <span class="hljs-keyword">is</span> hello my <span class="hljs-type">name</span> <span class="hljs-keyword">is</span> van<br>The <span class="hljs-number">2</span> <span class="hljs-type">line</span> <span class="hljs-keyword">is</span> i am an artist<br>The <span class="hljs-number">3</span> <span class="hljs-type">line</span> <span class="hljs-keyword">is</span> a performance artist<br></code></pre></td></tr></table></figure>

<ol start="7">
<li>遍历目录</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">p = Path(<span class="hljs-string">&#x27;.&#x27;</span>)<br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> p.iterdir():<br>    <span class="hljs-built_in">print</span>(file)  <span class="hljs-comment"># 打印当前目录下的所有文件和目录</span><br></code></pre></td></tr></table></figure>

<ol start="8">
<li>查找文件</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 查找当前目录下的所有 .txt 文件</span><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> p.glob(<span class="hljs-string">&#x27;*.txt&#x27;</span>):<br>    <span class="hljs-built_in">print</span>(file)<br></code></pre></td></tr></table></figure>

<ol start="9">
<li>删除文件或目录</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 删除文件</span><br>p = Path(<span class="hljs-string">&#x27;example.txt&#x27;</span>)<br>p.unlink()<br><br><span class="hljs-comment"># 删除目录（目录必须为空）</span><br>p = Path(<span class="hljs-string">&#x27;empty_directory&#x27;</span>)<br>p.rmdir()<br></code></pre></td></tr></table></figure>

<p>   10.获取当前文件目录（这里使用了<strong>os</strong>库）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><span class="hljs-comment"># 获取当前工作目录</span><br>cwd = os.getcwd()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前工作目录: <span class="hljs-subst">&#123;cwd&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 使用 Path.cwd() 获取当前工作目录</span><br>cwd_path = Path.cwd()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前工作目录: <span class="hljs-subst">&#123;cwd_path&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 获取的是根目录</span><br></code></pre></td></tr></table></figure>

<h2 id="FileNotFoundError"><a href="#FileNotFoundError" class="headerlink" title="FileNotFoundError"></a><code>FileNotFoundError</code></h2><p>当我们进行文件操作时，一不小心可能会拼错或者搞错了文件的路径，导致<strong>程序无法找到对应的文件</strong>。</p>
<p>例如，如下程序的目录中有文件<code>example.txt</code>，但没有<code>exammple.txt</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><span class="hljs-comment"># for a neater traceback information</span><br><span class="hljs-keyword">from</span> rich <span class="hljs-keyword">import</span> traceback<br>traceback.install(show_locals=<span class="hljs-literal">True</span>)<br><br><br>correct_path = Path(<span class="hljs-string">&quot;example.txt&quot;</span>)<br>wrong_path = Path(<span class="hljs-string">&quot;exammple.txt&quot;</span>)<br><br>contents_correct = correct_path.read_text()<br>contents_wrong = wrong_path.read_text()<br></code></pre></td></tr></table></figure>

<p>程序的输出结果如下：</p>
<p><img src="https://ooo.0x0.ooo/2025/01/20/OGktrC.png" srcset="/img/loading.gif" lazyload alt="FileNotfound Error"></p>
<p>归根结底就一句话：<code>FileNotFoundError: [Errno 2] No such file or directory: &#39;exammple.txt&#39;</code>。</p>
<p>和C++一样，Python也有<strong>异常处理</strong>的机制。<code>FileNotFoundError</code> 是 Python 中的一个<strong>内置异常类</strong>，用于表示程序尝试访问一个不存在的文件或目录时抛出的错误。它是 <code>OSError</code> 的子类（在 Python 3.3 之前是 <code>IOError</code> 的子类），专门用于处理文件未找到的情况。</p>
<p>在C++中，我们可以使用<code>try-catch</code>块来捕获异常，保证其他程序的正常运行，在Python中，<code>try-except</code>块也发挥了类似的作用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><span class="hljs-comment"># for a neater traceback information</span><br><span class="hljs-keyword">from</span> rich <span class="hljs-keyword">import</span> traceback<br>traceback.install(show_locals=<span class="hljs-literal">True</span>)<br><br><br>correct_path = Path(<span class="hljs-string">&quot;example.txt&quot;</span>)<br>wrong_path = Path(<span class="hljs-string">&quot;exammple.txt&quot;</span>)<br><br>contents_correct = correct_path.read_text()<br><br><span class="hljs-keyword">try</span>:<br>    contents_wrong = wrong_path.read_text()<br><span class="hljs-keyword">except</span> FileNotFoundError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Haha,File not found!&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>再次运行程序，就不会出现<code>traceback</code>报错，而只会输出：<code>Haha,File not found!</code></p>
<h2 id="Data-Storage：JSON"><a href="#Data-Storage：JSON" class="headerlink" title="Data Storage：JSON"></a>Data Storage：<code>JSON</code></h2><h3 id="What-is-JSON"><a href="#What-is-JSON" class="headerlink" title="What is JSON ?"></a>What is <code>JSON</code> ?</h3><p><strong>JSON 文件</strong> 是一种用于<strong>存储和交换数据的文件格式</strong>，全称是 <strong>JavaScript Object Notation</strong>（JavaScript 对象表示法）。它的设计目标是易于人类阅读和编写，同时也易于机器解析和生成。</p>
<p>JSON 文件的内容是由 <strong>“键值对”</strong> 组成的，就像字典一样。是一种轻量级的数据格式。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Alice&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;isStudent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;courses&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Math&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Science&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;History&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Beijing&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;postalCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;100000&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p><code>JSON</code>文件最强大的用处在于<strong>数据的传输和存储</strong>，例如前后端之间API的调用、软件的配置信息、存储结构化数据（日志，用户信息）等等。</p>
<h3 id="JSON-in-Python"><a href="#JSON-in-Python" class="headerlink" title="JSON in Python"></a><code>JSON</code> in Python</h3><p>在Python中，也可以使用<code>json</code>模块来进行文件管理。</p>
<ol>
<li><strong>将 Python 对象转换为 JSON 字符串</strong></li>
</ol>
<p>使用 <code>json.dumps()</code> 可以将 Python 对象（如字典、列表）转换为 JSON 格式的字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># 准备数据</span><br>data = &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;小红&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-string">&quot;isStudent&quot;</span>: <span class="hljs-literal">False</span>,<br>    <span class="hljs-string">&quot;favoriteFoods&quot;</span>: [<span class="hljs-string">&quot;火锅&quot;</span>, <span class="hljs-string">&quot;冰淇淋&quot;</span>]<br>&#125;<br><br><span class="hljs-comment"># 将 Python 对象转换为 JSON 字符串</span><br>json_string = json.dumps(data, indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>)<br><span class="hljs-comment"># 这一步会在当前目录下生成一个data.json文件</span><br><span class="hljs-built_in">print</span>(json_string)<br><br><br><span class="hljs-comment"># 使用 pathlib 写入文件</span><br>file_path = Path(<span class="hljs-string">&quot;data.json&quot;</span>)<br>file_path.write_text(json_string, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;小明&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;isStudent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hobbies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;打篮球&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;听音乐&quot;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>**<code>indent=4</code>**：让 JSON 字符串格式化输出，缩进 4 个空格。</li>
<li>**<code>ensure_ascii=False</code>**：确保非 ASCII 字符（如中文）正常显示。</li>
</ul>
<ol start="2">
<li><strong>将 JSON 字符串转换为 Python 对象</strong></li>
</ol>
<p>使用 <code>json.loads()</code> 可以将 JSON 格式的字符串转换为 Python 对象（如字典、列表）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># 使用 pathlib 读取文件</span><br>file_path = Path(<span class="hljs-string">&quot;data.json&quot;</span>)<br>json_string = file_path.read_text(encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br><br><span class="hljs-comment"># 将 JSON 字符串转换为 Python 对象</span><br>data = json.loads(json_string)<br><span class="hljs-built_in">print</span>(data[<span class="hljs-string">&quot;name&quot;</span>])  <span class="hljs-comment"># 输出：小红</span><br><span class="hljs-built_in">print</span>(data[<span class="hljs-string">&quot;favoriteFoods&quot;</span>])  <span class="hljs-comment"># 输出：[&#x27;火锅&#x27;, &#x27;冰淇淋&#x27;]</span><br></code></pre></td></tr></table></figure>

<h3 id="Usage-User-info-management"><a href="#Usage-User-info-management" class="headerlink" title="Usage: User_info management"></a>Usage: User_info management</h3><p>学会了<code>json</code>的基本操作后，我们可以实现一个<strong>迷你数据库</strong>：用来存储用户的数据，进行读写等操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># 获取用户输入的名字</span><br>user_name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Hello! What is your name? &quot;</span>)<br>user_name_path = Path(<span class="hljs-string">&quot;user_info.json&quot;</span>)<br><br><span class="hljs-comment"># 初始化用户数据</span><br>all_user_data = []<br><br><span class="hljs-comment"># 如果文件存在，读取文件内容</span><br><span class="hljs-keyword">if</span> user_name_path.exists():<br>    all_user_contents = user_name_path.read_text(encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    all_user_data = json.loads(all_user_contents)<br><br><span class="hljs-comment"># 检查用户是否已经存在</span><br>user_exists = <span class="hljs-literal">False</span><br>user_info = <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> all_user_data:<br>    <span class="hljs-keyword">if</span> user.get(<span class="hljs-string">&quot;name&quot;</span>) == user_name:<br>        user_exists = <span class="hljs-literal">True</span><br>        user_info = user<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">if</span> user_exists:<br>    <span class="hljs-comment"># 用户已经注册过</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Welcome Back, <span class="hljs-subst">&#123;user_name&#125;</span>!&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Your favourite food is <span class="hljs-subst">&#123;user_info.get(<span class="hljs-string">&#x27;food&#x27;</span>)&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 新用户</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Hello <span class="hljs-subst">&#123;user_name&#125;</span>! It seems that you are new here.&quot;</span>)<br>    fav_food = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What is your favourite food? &quot;</span>)<br><br>    <span class="hljs-comment"># 创建新用户数据</span><br>    new_user = &#123;<br>        <span class="hljs-string">&quot;name&quot;</span>: user_name,<br>        <span class="hljs-string">&quot;food&quot;</span>: fav_food<br>    &#125;<br><br>    <span class="hljs-comment"># 将新用户添加到用户列表中</span><br>    all_user_data.append(new_user)<br><br>    <span class="hljs-comment"># 将更新后的用户列表写入文件</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;user_info.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> json_file:<br>        json.dump(all_user_data, json_file, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">4</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your information has been saved. Welcome!&quot;</span>)<br></code></pre></td></tr></table></figure>

<p><strong>这样的Python代码习惯实在是太差了！</strong>下面是对函数体封装后的优化写法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_user_data</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    从 JSON 文件加载用户数据。</span><br><span class="hljs-string">    如果文件不存在，返回空列表。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> file_path.exists():<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> file:<br>                <span class="hljs-keyword">return</span> json.load(file)<br>        <span class="hljs-keyword">except</span> json.JSONDecodeError:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;错误：文件 <span class="hljs-subst">&#123;file_path&#125;</span> 不是有效的 JSON 文件！&quot;</span>)<br>            <span class="hljs-keyword">return</span> []<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> []<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_user_data</span>(<span class="hljs-params">file_path, data</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    将用户数据保存到 JSON 文件。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&quot;w&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> file:<br>        json.dump(data, file, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">4</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_user_by_name</span>(<span class="hljs-params">users, name</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    在用户列表中查找指定名字的用户。</span><br><span class="hljs-string">    如果找到，返回用户信息；否则返回 None。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:<br>        <span class="hljs-keyword">if</span> user.get(<span class="hljs-string">&quot;name&quot;</span>) == name:<br>            <span class="hljs-keyword">return</span> user<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">register_new_user</span>(<span class="hljs-params">users, name</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    注册新用户并返回更新后的用户列表。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Hello <span class="hljs-subst">&#123;name&#125;</span>! It seems that you are new here.&quot;</span>)<br>    fav_food = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What is your favourite food? &quot;</span>)<br>    new_user = &#123;<span class="hljs-string">&quot;name&quot;</span>: name, <span class="hljs-string">&quot;food&quot;</span>: fav_food&#125;<br>    users.append(new_user)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your information has been saved. Welcome!&quot;</span>)<br>    <span class="hljs-keyword">return</span> users<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    主程序逻辑。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 文件路径</span><br>    user_file_path = Path(<span class="hljs-string">&quot;user_info.json&quot;</span>)<br><br>    <span class="hljs-comment"># 加载用户数据</span><br>    users = load_user_data(user_file_path)<br><br>    <span class="hljs-comment"># 获取用户输入的名字</span><br>    user_name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Hello! What is your name? &quot;</span>)<br><br>    <span class="hljs-comment"># 查找用户是否已存在</span><br>    user_info = find_user_by_name(users, user_name)<br><br>    <span class="hljs-keyword">if</span> user_info:<br>        <span class="hljs-comment"># 用户已存在</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Welcome Back, <span class="hljs-subst">&#123;user_name&#125;</span>!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Your favourite food is <span class="hljs-subst">&#123;user_info.get(<span class="hljs-string">&#x27;food&#x27;</span>)&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 新用户注册</span><br>        users = register_new_user(users, user_name)<br>        <span class="hljs-comment"># 保存更新后的用户数据</span><br>        save_user_data(user_file_path, users)<br><br><span class="hljs-comment"># 运行主程序</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<h2 id="Project-Data-Visualization"><a href="#Project-Data-Visualization" class="headerlink" title="Project: Data Visualization"></a>Project: Data Visualization</h2><h3 id="Chapter-15-Data-Creation"><a href="#Chapter-15-Data-Creation" class="headerlink" title="Chapter 15 Data_Creation"></a>Chapter 15 Data_Creation</h3><h4 id="Matplotlib"><a href="#Matplotlib" class="headerlink" title="Matplotlib"></a><code>Matplotlib</code></h4><p>Python的强大之处之一在于<strong>其活跃的社区生态</strong>，通过<code>pip install</code>他人的第三方库，我们可以实现更多强大的功能，接下来的章节笔者将重点介绍<code>Matplotlib</code>的使用。</p>
<blockquote>
<p>这一章的学习非常有趣，强烈建议初学者一起上手操作。</p>
</blockquote>
<p><code>Matplotlib</code> 是 Python 中最流行的数据可视化库之一，广泛用于创建静态、动态和交互式的图表。它提供了类似于 MATLAB 的绘图接口，简单易用且功能强大。以下是 <code>Matplotlib</code> 的简单介绍和基本用法：</p>
<p>(1) <strong>绘制简单的折线图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br><br><span class="hljs-comment"># 创建图表</span><br>plt.plot(x, y)<br><br><span class="hljs-comment"># 添加标题和标签</span><br>plt.title(<span class="hljs-string">&quot;Simple Line Plot&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;X-axis&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;Y-axis&quot;</span>)<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<img src="https://matplotlib.org/stable/_images/sphx_glr_pyplot_001.png" srcset="/img/loading.gif" lazyload alt="Simple Line Plot" style="zoom:67%;" />

<p>(2) <strong>绘制散点图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br><br><span class="hljs-comment"># 创建散点图</span><br>plt.scatter(x, y, s=<span class="hljs-number">10</span>)<br><span class="hljs-comment"># s代表点的大小</span><br><br><span class="hljs-comment"># 添加标题和标签</span><br>plt.title(<span class="hljs-string">&quot;Scatter Plot&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;X-axis&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;Y-axis&quot;</span>)<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<img src="https://matplotlib.org/stable/_images/sphx_glr_scatter_001.png" srcset="/img/loading.gif" lazyload alt="Scatter Plot" style="zoom:67%;" />

<p>(3) <strong>绘制柱状图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>categories = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>values = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>]<br><br><span class="hljs-comment"># 创建柱状图</span><br>plt.bar(categories, values)<br><br><span class="hljs-comment"># 添加标题和标签</span><br>plt.title(<span class="hljs-string">&quot;Bar Chart&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;Categories&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;Values&quot;</span>)<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>



<p><img src="https://matplotlib.org/stable/_images/sphx_glr_bar_001.png" srcset="/img/loading.gif" lazyload alt="Bar Chart"></p>
<p>(4) <strong>绘制饼图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>labels = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>sizes = [<span class="hljs-number">15</span>, <span class="hljs-number">30</span>, <span class="hljs-number">45</span>, <span class="hljs-number">10</span>]<br><br><span class="hljs-comment"># 创建饼图</span><br>plt.pie(sizes, labels=labels, autopct=<span class="hljs-string">&#x27;%1.1f%%&#x27;</span>)<br><br><span class="hljs-comment"># 添加标题</span><br>plt.title(<span class="hljs-string">&quot;Pie Chart&quot;</span>)<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<p><img src="https://matplotlib.org/stable/_images/sphx_glr_pie_001.png" srcset="/img/loading.gif" lazyload alt="Pie Chart"></p>
<p>使用 <code>plt.subplots</code> 可以在一个窗口中绘制多个子图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y1 = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br>y2 = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">25</span>]<br><br><span class="hljs-comment"># 创建子图</span><br>fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>))<br><br><span class="hljs-comment"># 子图 1：折线图</span><br>ax1.plot(x, y1)<br>ax1.set_title(<span class="hljs-string">&quot;Line Plot&quot;</span>)<br><br><span class="hljs-comment"># 子图 2：散点图</span><br>ax2.scatter(x, y2)<br>ax2.set_title(<span class="hljs-string">&quot;Scatter Plot&quot;</span>)<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<p><img src="https://ooo.0x0.ooo/2025/01/20/OGkwSP.png" srcset="/img/loading.gif" lazyload alt="Subplots"></p>
<p><code>Matplotlib</code> 支持丰富的自定义选项，例如颜色、线型、标记等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br><br><span class="hljs-comment"># 创建图表</span><br>plt.plot(x, y, color=<span class="hljs-string">&#x27;red&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>, marker=<span class="hljs-string">&#x27;o&#x27;</span>, label=<span class="hljs-string">&#x27;Data&#x27;</span>)<br><br><span class="hljs-comment"># 添加标题、标签和图例</span><br>plt.title(<span class="hljs-string">&quot;Customized Line Plot&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;X-axis&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;Y-axis&quot;</span>)<br>plt.legend()<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<p><img src="https://matplotlib.org/stable/_images/sphx_glr_line_demo_dash_control_001.png" srcset="/img/loading.gif" lazyload alt="Customized Line Plot"></p>
<p>使用 <code>plt.savefig</code> 可以将图表保存为图片文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br><br><span class="hljs-comment"># 创建图表</span><br>plt.plot(x, y)<br><br><span class="hljs-comment"># 保存图表</span><br>plt.savefig(<span class="hljs-string">&quot;line_plot.png&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>也可以使用<strong>内置样式</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 查看所有内置样式</span><br><span class="hljs-built_in">print</span>(plt.style.available)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 应用内置样式</span><br>plt.style.use(<span class="hljs-string">&#x27;seaborn-v0_8-dark&#x27;</span>)<br><br><span class="hljs-comment"># 数据</span><br>x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>y = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]<br><br><span class="hljs-comment"># 创建图表</span><br>plt.plot(x, y, label=<span class="hljs-string">&quot;Data&quot;</span>)<br><br><span class="hljs-comment"># 添加标题和标签</span><br>plt.title(<span class="hljs-string">&quot;Line Plot with Seaborn Darkgrid Style&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;X-axis&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;Y-axis&quot;</span>)<br><br><span class="hljs-comment"># 添加图例</span><br>plt.legend()<br><br><span class="hljs-comment"># 显示图表</span><br>plt.show()<br></code></pre></td></tr></table></figure>

<blockquote>
<p>Matplotlib提供了很多自定义的设置，例如<code>ticklable_format(style=)</code>来设置<strong>刻度标记</strong>，自定义RGB颜色<code>color=(0,0.8,0)</code></p>
</blockquote>
<h4 id="Application：Random-Walk"><a href="#Application：Random-Walk" class="headerlink" title="Application：Random Walk"></a>Application：Random Walk</h4><p>下文给出实现<code>Random Walk</code> 的Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RandomWalk</span>:<br>    <span class="hljs-string">&#x27;&#x27;&#x27;A class represents the random walk&#x27;&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, num_points=<span class="hljs-number">500</span></span>):<br>        <span class="hljs-variable language_">self</span>.num_points = num_points<br><br>        <span class="hljs-variable language_">self</span>.x_values=[<span class="hljs-number">0</span>]<br>        <span class="hljs-variable language_">self</span>.y_values=[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fill_walk</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>((<span class="hljs-variable language_">self</span>.x_values))&lt;<span class="hljs-variable language_">self</span>.num_points:<br>            x_direction = choice([<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>])<br>            x_distance = choice([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])<br>            x_step = x_distance * x_direction<br><br>            y_direction = choice([<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>])<br>            y_distance = choice([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])<br>            y_step = y_distance * y_direction<br><br>            <span class="hljs-keyword">if</span> x_step==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y_step==<span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br><br>            x_new = <span class="hljs-variable language_">self</span>.x_values[-<span class="hljs-number">1</span>] + x_step<br>            y_new = <span class="hljs-variable language_">self</span>.y_values[-<span class="hljs-number">1</span>] + y_step<br><br>            <span class="hljs-variable language_">self</span>.x_values.append(x_new)<br>            <span class="hljs-variable language_">self</span>.y_values.append(y_new)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">imitate_walk</span>(<span class="hljs-params">index</span>):<br>    Total_steps= <span class="hljs-number">10000</span><br>    rw_orange = RandomWalk(Total_steps)<br>    rw_red = RandomWalk(Total_steps)<br>    rw_blue = RandomWalk(Total_steps)<br><br>    rw_orange.fill_walk()<br>    rw_blue.fill_walk()<br>    rw_red.fill_walk()<br><br>    plt.style.use(<span class="hljs-string">&#x27;classic&#x27;</span>)<br>    fig, ax = plt.subplots()<br>    point_numbers = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(Total_steps))<br><br>    ax.scatter(rw_orange.x_values, rw_orange.y_values, c=point_numbers,cmap=plt.cm.Oranges,edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>, s=<span class="hljs-number">2</span>)<br>    ax.scatter(rw_blue.x_values, rw_blue.y_values, c=point_numbers,cmap=plt.cm.Blues,edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>, s=<span class="hljs-number">2</span>)<br>    ax.scatter(rw_red.x_values, rw_red.y_values, c=point_numbers,cmap=plt.cm.Reds,edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>, s=<span class="hljs-number">2</span>)<br><br><br>    ax.set_aspect(<span class="hljs-string">&#x27;equal&#x27;</span>)<br><br>    ax.get_xaxis().set_visible(<span class="hljs-literal">False</span>)<br>    ax.get_yaxis().set_visible(<span class="hljs-literal">False</span>)<br><br><br>    plt.suptitle(<span class="hljs-string">f&#x27;Random Walk<span class="hljs-subst">&#123;index+<span class="hljs-number">1</span>&#125;</span>&#x27;</span>, fontsize=<span class="hljs-number">16</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>)<br>    plt.savefig(<span class="hljs-string">f&#x27;Random_walk<span class="hljs-subst">&#123;index+<span class="hljs-number">1</span>&#125;</span>.png&#x27;</span>, bbox_inches=<span class="hljs-string">&#x27;tight&#x27;</span>)<br>    plt.close()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>)):<br>        imitate_walk(i)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-string">&#x27;&#x27;&#x27;The main function&#x27;&#x27;&#x27;</span><br>    main()<br><br></code></pre></td></tr></table></figure>

<p>这个代码会实现1000次的Random_Walk，其中每一次的步长为10000。最后画出的图片效果还是非常震撼的！</p>
<h3 id="Chapter-16-Download-Data"><a href="#Chapter-16-Download-Data" class="headerlink" title="Chapter 16 Download Data"></a>Chapter 16 Download Data</h3><h4 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h4><p>CSV（Comma-Separated Values，逗号分隔值）是一种简单的文件格式，用于存储和交换表格数据。它以纯文本形式存储数据，每行代表一条记录，每个字段用逗号分隔。CSV 文件易于生成和解析，广泛应用于数据存储、导入和导出。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-built_in">Name,</span>Age,City<br><span class="hljs-built_in">Alice,</span><span class="hljs-number">30</span>,<span class="hljs-keyword">New</span> York<br><span class="hljs-built_in">Bob,</span><span class="hljs-number">25</span>,Los Angeles<br><span class="hljs-built_in">Charlie,</span><span class="hljs-number">35</span>,Chicago<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>表头（Header）</strong>：第一行通常是字段名称（如 <code>Name, Age, City</code>）。</li>
<li><strong>数据行</strong>：每行代表一条记录，字段之间用逗号分隔。</li>
<li><strong>分隔符</strong>：默认是逗号（<code>,</code>），但也可以是其他字符（如分号 <code>;</code> 或制表符 <code>\t</code>）。</li>
</ul>
<p>我们会发现，CSV数据文件阅读起来还是比较麻烦的，（作为存储便捷性的牺牲）我们可以使用Python来帮助我们解析CSV数据并且完成数据的可视化。</p>
<h3 id="CSV-in-Python：Data-Processing"><a href="#CSV-in-Python：Data-Processing" class="headerlink" title="CSV in Python：Data Processing"></a>CSV in Python：Data Processing</h3><p>在原书中，作者使用了天气数据作为示范，我们可以来一点更好玩的~</p>
<p>在接下来的篇幅中，笔者将使用<strong>Python完成一个简单的机器学习项目——Titanic二分类问题</strong></p>
<p>数据集来源：<a target="_blank" rel="noopener" href="https://www.kaggle.com/c/titanic/overview">Kaggle Titanic</a></p>
<p>在Vscode中新建一个文件夹作为项目主目录，并且下载官方提供的数据集：<code>gender_submission.csv</code>,<code>test.csv</code>,<code>train.csv</code></p>
<p>先看看官方给我们的要求是什么：</p>
<blockquote>
<p><strong>The training set</strong> should be used to build your machine learning models. For the training set, we provide the outcome (also known as the “ground truth”) for each passenger. Your model will be based on “features” like passengers’ gender and class. You can also use <a target="_blank" rel="noopener" href="https://triangleinequality.wordpress.com/2013/09/08/basic-feature-engineering-with-the-titanic-data/">feature engineering </a>to create new features.</p>
<p><strong>The test set</strong> should be used to see how well your model performs on unseen data. For the test set, we do not provide the ground truth for each passenger. It is your job to predict these outcomes. For each passenger in the test set, use the model you trained to predict whether or not they survived the sinking of the Titanic.</p>
<p>We also include <strong>gender_submission.csv</strong>, a set of predictions that assume all and only female passengers survive, as an example of what a submission file should look like.</p>
</blockquote>
<p>通俗来说，就是给了泰坦尼克号上部分成员的数据信息，然后建立自己的机器学习模型预测<strong>“ground truth”</strong>,最后提交一份类似于<code>gender_submission.csv</code>的报告（第三份文件只是输出示例，假设所有女人幸存而所有男人牺牲）</p>
<h5 id="Loading-Data"><a href="#Loading-Data" class="headerlink" title="Loading Data"></a>Loading Data</h5><p>我们首先需要<strong>读取csv文件中的数据</strong>，可以使用Python中的<code>csv</code>模块。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> csv<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><span class="hljs-keyword">import</span> json<br><br>test_data_path = Path(<span class="hljs-string">&#x27;test.csv&#x27;</span>)<br>train_data_path = Path(<span class="hljs-string">&#x27;train.csv&#x27;</span>)<br><br>train_lines = train_data_path.read_text().splitlines()<br>test_lines = test_data_path.read_text().splitlines()<br><span class="hljs-comment"># 将文本字符串按行拆分成列表</span><br><br>train_reader = csv.reader(train_lines)<br>test_reader = csv.reader(test_lines)<br><br>header_row_train = <span class="hljs-built_in">next</span>(train_reader)<br>header_row_test = <span class="hljs-built_in">next</span>(test_reader)<br><span class="hljs-comment">#得到第一行题头</span><br><br><span class="hljs-built_in">print</span>(header_row_train)<br><span class="hljs-built_in">print</span>(header_row_test)<br><br></code></pre></td></tr></table></figure>

<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scheme">[<span class="hljs-symbol">&#x27;PassengerId</span>&#x27;, <span class="hljs-symbol">&#x27;Survived</span>&#x27;, <span class="hljs-symbol">&#x27;Pclass</span>&#x27;, <span class="hljs-symbol">&#x27;Name</span>&#x27;, <span class="hljs-symbol">&#x27;Sex</span>&#x27;, <span class="hljs-symbol">&#x27;Age</span>&#x27;, <span class="hljs-symbol">&#x27;SibSp</span>&#x27;, <span class="hljs-symbol">&#x27;Parch</span>&#x27;, <span class="hljs-symbol">&#x27;Ticket</span>&#x27;, <span class="hljs-symbol">&#x27;Fare</span>&#x27;, <span class="hljs-symbol">&#x27;Cabin</span>&#x27;, <span class="hljs-symbol">&#x27;Embarked</span>&#x27;]<br>[<span class="hljs-symbol">&#x27;PassengerId</span>&#x27;, <span class="hljs-symbol">&#x27;Pclass</span>&#x27;, <span class="hljs-symbol">&#x27;Name</span>&#x27;, <span class="hljs-symbol">&#x27;Sex</span>&#x27;, <span class="hljs-symbol">&#x27;Age</span>&#x27;, <span class="hljs-symbol">&#x27;SibSp</span>&#x27;, <span class="hljs-symbol">&#x27;Parch</span>&#x27;, <span class="hljs-symbol">&#x27;Ticket</span>&#x27;, <span class="hljs-symbol">&#x27;Fare</span>&#x27;, <span class="hljs-symbol">&#x27;Cabin</span>&#x27;, <span class="hljs-symbol">&#x27;Embarked</span>&#x27;]<br></code></pre></td></tr></table></figure>

<p>接下来，我们将要将数据处理成方便获取的JSON格式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Python">train_data_json = []<br>test_data_json = []<br><br><span class="hljs-comment"># 将训练集数据转换为 JSON</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> train_reader:<br>    <span class="hljs-comment"># 将每一行数据与题头组合成字典</span><br>    row_dict = &#123;header: value <span class="hljs-keyword">for</span> header, value <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(header_row_train, row)&#125;<br>    train_data_json.append(row_dict)<br><br><span class="hljs-comment"># 将测试集数据转换为 JSON</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> test_reader:<br>    <span class="hljs-comment"># 将每一行数据与题头组合成字典</span><br>    row_dict = &#123;header: value <span class="hljs-keyword">for</span> header, value <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(header_row_test, row)&#125;<br>    test_data_json.append(row_dict)<br><br><span class="hljs-comment"># 打印结果</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;训练集 JSON 数据：&quot;</span>)<br><span class="hljs-built_in">print</span>(train_data_json[:<span class="hljs-number">2</span>])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n测试集 JSON 数据：&quot;</span>)<br><span class="hljs-built_in">print</span>(test_data_json[:<span class="hljs-number">2</span>])<br><br><span class="hljs-comment"># 保存训练集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;train_data.json&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    json.dump(train_data_json, f, indent=<span class="hljs-number">2</span>)  <span class="hljs-comment"># indent=2 用于美化输出</span><br><br><span class="hljs-comment"># 保存测试集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_data.json&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    json.dump(test_data_json, f, indent=<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>

<p>运行程序，我们就成功的把csv格式的文件存储成为<code>JSON</code>文件！</p>
<h5 id="Data-Washing"><a href="#Data-Washing" class="headerlink" title="Data Washing"></a>Data Washing</h5><p>接下来，我们需要进行数据的预处理，包括<strong>处理空缺的数据</strong>等等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-string">&#x27;&#x27;&#x27;Data washing&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># 加载训练集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;train_data.json&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    train_data = json.load(f)<br><br><span class="hljs-comment"># 加载测试集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_data.json&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    test_data = json.load(f)<br><br><br><span class="hljs-comment"># 将 JSON 数据转换为 DataFrame</span><br>train_df = pd.DataFrame(train_data)<br>test_df = pd.DataFrame(test_data)<br><br><span class="hljs-comment"># 将字符串类型的数值转换为数值类型</span><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br><br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br><br><br><span class="hljs-comment"># 处理缺失值</span><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].fillna(train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].median())<br>train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].fillna(train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].mode()[<span class="hljs-number">0</span>])<br>train_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>].fillna(<span class="hljs-string">&#x27;Unknown&#x27;</span>)<br><br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].fillna(test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].median())<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].fillna(test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].median())<br>test_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>].fillna(<span class="hljs-string">&#x27;Unknown&#x27;</span>)<br><br><span class="hljs-comment"># check</span><br><span class="hljs-comment"># 检查训练集的缺失值</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;The loss of train set:&quot;</span>)<br><span class="hljs-built_in">print</span>(train_df.isnull().<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-comment"># 检查测试集的缺失值</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nThe loss of test set:&quot;</span>)<br><span class="hljs-built_in">print</span>(test_df.isnull().<span class="hljs-built_in">sum</span>())<br></code></pre></td></tr></table></figure>

<p>检查输出，说明数据预处理完成。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">The loss of train <span class="hljs-built_in">set</span>:<br>PassengerId    0<br>Survived       0<br>Pclass         0<br>Name           0<br>Sex            0<br>Age            0<br>SibSp          0<br>Parch          0<br>Ticket         0<br>Fare           0<br>Cabin          0<br>Embarked       0<br>dtype: int64<br><br>The loss of <span class="hljs-built_in">test</span> <span class="hljs-built_in">set</span>:<br>PassengerId    0<br>Pclass         0<br>Name           0<br>Sex            0<br>Age            0<br>SibSp          0<br>Parch          0<br>Ticket         0<br>Fare           0<br>Cabin          0<br>Embarked       0<br>dtype: int64<br></code></pre></td></tr></table></figure>

<blockquote>
<p>这就是第一步储存在<code>JSON</code>的好处，模块化的处理保证了程序员可以独立地执行各部分的程序，如果出错了也可以重新进行Loading Data获得原始数据。</p>
</blockquote>
<h5 id="Machine-Learning"><a href="#Machine-Learning" class="headerlink" title="Machine Learning"></a>Machine Learning</h5><p>接下来就是<strong>机器学习</strong>的专场了，笔者使用的是<strong>随机森林RandomBoost</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># %%</span><br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># %%</span><br><br><span class="hljs-string">&#x27;&#x27;&#x27;Data washing&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># 加载训练集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;train_data.json&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    train_data = json.load(f)<br><br><span class="hljs-comment"># 加载测试集 JSON 数据</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_data.json&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    test_data = json.load(f)<br><br><br><span class="hljs-comment"># 将 JSON 数据转换为 DataFrame</span><br>train_df = pd.DataFrame(train_data)<br>test_df = pd.DataFrame(test_data)<br><br><span class="hljs-comment"># 将字符串类型的数值转换为数值类型</span><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].replace(<span class="hljs-string">&#x27;&#x27;</span>, np.nan)<br><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br><br>train_df[<span class="hljs-string">&#x27;Parch&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Parch&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br>train_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>] = train_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br>train_df[<span class="hljs-string">&#x27;Pclass&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Pclass&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br><br><br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br><br>test_df[<span class="hljs-string">&#x27;Parch&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Parch&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br>test_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>] = test_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br>test_df[<span class="hljs-string">&#x27;Pclass&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Pclass&#x27;</span>].astype(<span class="hljs-built_in">int</span>)<br><br><br><span class="hljs-comment"># 处理缺失值</span><br>train_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].fillna(train_df[<span class="hljs-string">&#x27;Age&#x27;</span>].median())<br>train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].fillna(train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].mode()[<span class="hljs-number">0</span>])<br>train_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>].fillna(<span class="hljs-string">&#x27;Unknown&#x27;</span>)<br><br>test_df[<span class="hljs-string">&#x27;Age&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].fillna(test_df[<span class="hljs-string">&#x27;Age&#x27;</span>].median())<br>test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].fillna(test_df[<span class="hljs-string">&#x27;Fare&#x27;</span>].median())<br>test_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Cabin&#x27;</span>].fillna(<span class="hljs-string">&#x27;Unknown&#x27;</span>)<br><br><br><br><span class="hljs-comment"># check</span><br><span class="hljs-comment"># 检查训练集的缺失值</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;The loss of train set:&quot;</span>)<br><span class="hljs-built_in">print</span>(train_df.isnull().<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-comment"># 检查测试集的缺失值</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nThe loss of test set:&quot;</span>)<br><span class="hljs-built_in">print</span>(test_df.isnull().<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-comment"># 从姓名中提取称呼（如 Mr, Miss, Mrs）</span><br>train_df[<span class="hljs-string">&#x27;Title&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Name&#x27;</span>].apply(<span class="hljs-keyword">lambda</span> x: x.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>].strip())<br>test_df[<span class="hljs-string">&#x27;Title&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Name&#x27;</span>].apply(<span class="hljs-keyword">lambda</span> x: x.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>].strip())<br><br><span class="hljs-comment"># 将性别转换为数值</span><br>train_df[<span class="hljs-string">&#x27;Sex&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Sex&#x27;</span>].<span class="hljs-built_in">map</span>(&#123;<span class="hljs-string">&#x27;male&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;female&#x27;</span>: <span class="hljs-number">1</span>&#125;)<br>test_df[<span class="hljs-string">&#x27;Sex&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Sex&#x27;</span>].<span class="hljs-built_in">map</span>(&#123;<span class="hljs-string">&#x27;male&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;female&#x27;</span>: <span class="hljs-number">1</span>&#125;)<br><br><span class="hljs-comment"># 创建家庭大小特征</span><br>train_df[<span class="hljs-string">&#x27;FamilySize&#x27;</span>] = train_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>] + train_df[<span class="hljs-string">&#x27;Parch&#x27;</span>] + <span class="hljs-number">1</span><br>test_df[<span class="hljs-string">&#x27;FamilySize&#x27;</span>] = test_df[<span class="hljs-string">&#x27;SibSp&#x27;</span>] + test_df[<span class="hljs-string">&#x27;Parch&#x27;</span>] + <span class="hljs-number">1</span><br><br><span class="hljs-comment"># 将登船港口转换为数值</span><br>train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>] = train_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].<span class="hljs-built_in">map</span>(&#123;<span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Q&#x27;</span>: <span class="hljs-number">2</span>&#125;)<br>test_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>] = test_df[<span class="hljs-string">&#x27;Embarked&#x27;</span>].<span class="hljs-built_in">map</span>(&#123;<span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Q&#x27;</span>: <span class="hljs-number">2</span>&#125;)<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-comment"># 选择特征</span><br>features = [<span class="hljs-string">&#x27;Pclass&#x27;</span>, <span class="hljs-string">&#x27;Sex&#x27;</span>, <span class="hljs-string">&#x27;Age&#x27;</span>, <span class="hljs-string">&#x27;SibSp&#x27;</span>, <span class="hljs-string">&#x27;Parch&#x27;</span>, <span class="hljs-string">&#x27;Fare&#x27;</span>, <span class="hljs-string">&#x27;Embarked&#x27;</span>, <span class="hljs-string">&#x27;FamilySize&#x27;</span>]<br>X_train = train_df[features]<br>y_train = train_df[<span class="hljs-string">&#x27;Survived&#x27;</span>]<br><br>X_test = test_df[features]<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-built_in">print</span>(X_train.dtypes)<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier<br><br><span class="hljs-comment"># 初始化模型</span><br>model = RandomForestClassifier(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>)<br><br><span class="hljs-comment"># 训练模型</span><br>model.fit(X_train, y_train)<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score, confusion_matrix<br><br><span class="hljs-comment"># 在训练集上进行预测</span><br>y_train_pred = model.predict(X_train)<br><br><span class="hljs-comment"># 计算准确率</span><br>accuracy = accuracy_score(y_train, y_train_pred)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;训练集准确率: <span class="hljs-subst">&#123;accuracy:<span class="hljs-number">.2</span>f&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 绘制混淆矩阵</span><br>conf_matrix = confusion_matrix(y_train, y_train_pred)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;混淆矩阵:&quot;</span>)<br><span class="hljs-built_in">print</span>(conf_matrix)<br><br><span class="hljs-comment"># %%</span><br><span class="hljs-comment"># 对测试集进行预测</span><br>test_predictions = model.predict(X_test)<br><br><span class="hljs-comment"># 将预测结果保存到 CSV 文件</span><br>output = pd.DataFrame(&#123;<br>    <span class="hljs-string">&#x27;PassengerId&#x27;</span>: test_df[<span class="hljs-string">&#x27;PassengerId&#x27;</span>],<br>    <span class="hljs-string">&#x27;Survived&#x27;</span>: test_predictions<br>&#125;)<br>output.to_csv(<span class="hljs-string">&#x27;submission.csv&#x27;</span>, index=<span class="hljs-literal">False</span>)<br><br><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>相关文件将会开源到我的Github上。</p>
</blockquote>
<p>结果:clown_face:</p>
<p><img src="https://ooo.0x0.ooo/2025/01/21/OGF0ms.png" srcset="/img/loading.gif" lazyload alt="Result"></p>
<h3 id="Chapter-17-Using-API"><a href="#Chapter-17-Using-API" class="headerlink" title="Chapter 17 Using API"></a>Chapter 17 Using API</h3><h2 id="Advanced-Techniques"><a href="#Advanced-Techniques" class="headerlink" title="Advanced Techniques"></a>Advanced Techniques</h2>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Code/" class="category-chain-item">Code</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python/" class="print-no-link">#Python</a>
      
        <a href="/tags/Tutorial/" class="print-no-link">#Tutorial</a>
      
        <a href="/tags/Files/" class="print-no-link">#Files</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Python-Advanced-File-Management</div>
      <div>https://xiyuanyang-code.github.io/posts/Python-advanced-File-Management/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Xiyuan Yang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>January 16, 2025</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>February 17, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/Python-Update-Learning/" title="Python-Update-Learning">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Python-Update-Learning</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/Python-cheatsheet/" title="Python-Cheatsheet">
                        <span class="hidden-mobile">Python-Cheatsheet</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
    <div id="giscus" class="giscus"></div>
    <script type="text/javascript">
      Fluid.utils.loadComments('#giscus', function() {
        var options = {"repo":"xiyuanyang-code/xiyuanyang-code.github.io","repo-id":"R_kgDONRhvHQ","category":"Announcements","category-id":"DIC_kwDONRhvHc4ClBnp","theme-light":"light","theme-dark":"dark","mapping":"pathname","reactions-enabled":1,"emit-metadata":0,"input-position":"top","lang":"zh-CN"};
        var attributes = {};
        for (let option in options) {
          if (!option.startsWith('theme-')) {
            var key = option.startsWith('data-') ? option : 'data-' + option;
            attributes[key] = options[option];
          }
        }
        var light = 'light';
        var dark = 'dark';
        window.GiscusThemeLight = light;
        window.GiscusThemeDark = dark;
        attributes['data-theme'] = document.documentElement.getAttribute('data-user-color-scheme') === 'dark' ? dark : light;
        for (let attribute in attributes) {
          var value = attributes[attribute];
          if (value === undefined || value === null || value === '') {
            delete attributes[attribute];
          }
        }
        var s = document.createElement('script');
        s.setAttribute('src', 'https://giscus.app/client.js');
        s.setAttribute('crossorigin', 'anonymous');
        for (let attribute in attributes) {
          s.setAttribute(attribute, attributes[attribute]);
        }
        var ss = document.getElementsByTagName('script');
        var e = ss.length > 0 ? ss[ss.length - 1] : document.head || document.documentElement;
        e.parentNode.insertBefore(s, e.nextSibling);
      });
    </script>
    <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/xiyuanyang-code" target="_blank" rel="nofollow noopener"><span>YXY</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/Siyan-Li" target="_blank" rel="nofollow noopener"><span>LSY</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
